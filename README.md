# Проект 1

В базе две схемы: production и analysis. В схеме production содержатся оперативные таблицы.
Задача — построить витрину для RFM-классификации. Для анализа нужно отобрать только успешно выполненные заказы.
План создания витрины.
1) Необходимо знакомиться с таблицами и их данными в схеме production.
2) Исходя из условий задачи определить какие таблицы и поля нам нужны для расчетов метрик.
3) Присвоить каждому клиенту три значения — значение фактора Recency, значение фактора Frequency и значение фактора Monetary.
3.1) Фактор Recency измеряется по последнему заказу. 
-Распределить клиентов по шкале от одного до пяти, где значение 1 получат те, кто либо вообще не делал заказов, либо делал их очень давно, а 5 — те, кто заказывал относительно недавно.
3.2) Фактор Frequency оценивается по количеству заказов. Распределите клиентов по шкале от одного до пяти, где значение 1 получат клиенты с наименьшим количеством заказов, а 5 — с наибольшим.
3.3) Фактор Monetary оценивается по потраченной сумме. Распределите клиентов по шкале от одного до пяти, где значение 1 получат клиенты с наименьшей суммой, а 5 — с наибольшей.
Проверить, что количество клиентов в каждом сегменте одинаково.
Успешно выполненный заказ - «CLOSED».
4) Требования к витрине:
1.Витрина должна располагаться в той же базе в схеме analysis.
2.Витрина должна состоять из таких полей:
		user_id
		recency (число от 1 до 5)
		frequency (число от 1 до 5)
		monetary_value (число от 1 до 5)
3.В витрине нужны данные с начала 2021 года.
4.Назвать витрину dm_rfm_segments.
5.Обновления не нужны.

5) Для построения витрины в задании 1 понадобится только одна таблица 
Production.orders
 Для перестроения витрины в задании 2 нужны 2 таблицы
Production.orders, Production.orderstatuslog
6) Для метрик буду использовать агрегатные функции и case when конструкции.
7) Составление запросов, на основе которых я наполню view, для дальнейшего составления витрины. 
8) Создание представлений.
9) Загрузка данных в представления.
10) Сбор витрины.
